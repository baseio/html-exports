<!DOCTYPE html><html lang="en"><head><title>documentloader</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="documentloader"><meta name="groc-project-path" content="src/documentloader.js"><meta name="groc-github-url" content="https://github.com/nevir/html-exports"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/nevir/html-exports/blob/master/src/documentloader.js">src/documentloader.js</a></div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="documentloader">DocumentLoader</h1></div></div></div><div class="segment"><div class="code"><div class="wrapper">;(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(scope)</span> </span>{
<span class="hljs-pi">  'use strict'</span>

  scope.DocumentLoader = DocumentLoader</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p><code>HTMLExports.DocumentLoader</code> is a module loader that loads any modules with
a <code>.html</code> extension as a HTML module. See <a href="loaderhooks.html"><code>HTMLExports.LoaderHooks</code></a>
for the underlying behavior.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DocumentLoader</span><span class="hljs-params">(options)</span> </span>{
    Reflect.Loader.call(<span class="hljs-keyword">this</span>, options || {})
  }
  DocumentLoader.prototype = <span class="hljs-built_in">Object</span>.create(Reflect.Loader.prototype)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h3 id="-documentloader-mixin-"><code>DocumentLoader.mixin</code></h3></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Rather than instantiating and managing a <code>DocumentLoader</code> directly, you
will frequently want to mix <code>DocumentLoader</code>&#39;s behavior into an existing
loader.</p>
<p>For example, to override the default system loader:</p>
<pre><code class="lang-js">HTMLExports.DocumentLoader.mixin(System)</code></pre></div></div><div class="code"><div class="wrapper">  DocumentLoader.mixin = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixin</span><span class="hljs-params">(loader)</span> </span>{
    <span class="hljs-built_in">console</span>.debug(<span class="hljs-string">'DocumentLoader.mixin('</span>, loader, <span class="hljs-string">')'</span>)

    <span class="hljs-built_in">Object</span>.keys(scope.LoaderHooks).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(hookName)</span> </span>{
      <span class="hljs-built_in">console</span>.assert(hookName !== <span class="hljs-string">'normalize'</span>, <span class="hljs-string">'only supports hooks that accept a load record'</span>)

      <span class="hljs-keyword">var</span> htmlHook   = scope.LoaderHooks[hookName]
      <span class="hljs-keyword">var</span> parentHook = loader[hookName]
      loader[hookName] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(load)</span> </span>{
        <span class="hljs-keyword">return</span> (_isHtml(load) ? htmlHook : parentHook).apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>)
      }
    })</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>If the author is using es6-module-loader or SystemJS, an entry is added
to their <code>paths</code> property so that <code>.html</code> addresses are not resolved as
<code>.html.js</code>.</p></div></div><div class="code"><div class="wrapper">    <span class="hljs-keyword">if</span> (loader.paths) {
      loader.paths[<span class="hljs-string">'*.html'</span>] = <span class="hljs-string">'*.html'</span>
    }
  }

  DocumentLoader.mixin(DocumentLoader.prototype)</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h2 id="internal-implementation">Internal Implementation</h2></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Any module with an extension of <code>.html</code> is assumed to represent a HTML
document.</p>
<p>We cannot perform any smarter heuristics (such as checking content type),
as this check is performed before the <code>fetch</code> step completes.</p></div></div><div class="code"><div class="wrapper">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_isHtml</span><span class="hljs-params">(load)</span> </span>{
    <span class="hljs-keyword">var</span> path = load.address || load.name
    <span class="hljs-keyword">return</span> path &amp;&amp; path.slice(-<span class="hljs-number">5</span>) === <span class="hljs-string">'.html'</span>
  }

})(<span class="hljs-keyword">this</span>.HTMLExports = <span class="hljs-keyword">this</span>.HTMLExports || {})</div></div></div></div></body></html>